\documentclass[a4paper,10pt]{scrartcl}
\RequirePackage[hyperindex]{hyperref}
\usepackage{amssymb}
\begin{document}
\title{\texttt{cplint} on SWISH Manual}
\maketitle

%\section{Table of Contents}
%
%\begin{itemize}
%	\item \hyperref[syn]{Syntax} 
%	\item Inference \ref{inf}
%	\item Learning \ref{learning}
%\end{itemize}

\input{syntax}
\input{semantics}
\input{inference}

\verb|cplint| on SWISH allows two types of programs: LPAD and Prolog. In the first, you create a new LPAD in the editor, in the latter a Prolog program. 

In LPADs, you write in the editor the program without the library import and the compiler directives. \verb|pita| is used for inference.

You ask queries by writing the atom of which you want to compute the probability. In the coin example, the probability of \verb|heads(coin)| can be obtained with the 
\begin{verbatim}
?- heads(coin).
\end{verbatim}

In Prolog programs, you have to enter the program above (\verb|coin.pl|).

\input{inf_goals}

\input{graphics}

\input{parameters}

\input{learning}

\subsection{Commands}
\subsubsection{Parameter Learning}
To execute EMBLEM, prepare an input file in the editor panel as indicated above 
and call
\begin{verbatim}
?- induce_par(<list of folds>,P).
\end{verbatim}
where \verb|<list of folds>| is a list of the folds for training and
\verb|P| will contain the input program with updated parameters.

For example \href{http://cplint.lamping.unife.it/example/bongard.pl}{\texttt{bongard.pl}}, you can 
perform parameter learning on the \verb|train| fold with 
\begin{verbatim}
?- induce_par([train],P).
\end{verbatim}
A program can also be tested on a test set with
\begin{verbatim}
?- test(<program>,<list of folds>,LL,AUCROC,ROC,AUCPR,PR).
\end{verbatim}
where \verb|<program>| is a list of terms representing clauses and
\verb|<list of folds>| is a list of folds.
This returns the log likelihood of the test examples in \verb|LL|, the Area Under the ROC curve in \verb|AUCROC|, a dictionary containing the list of points (in the form of Prolog pairs \verb|x-y|) of the ROC curve in \verb|ROC|,
the Area Under the PR curve in \verb|AUCPR|, a dictionary containing the list of points of the PR curve in \verb|PR|.

For example, to test on fold \verb|test| the program learned on fold \verb|train| you can run the query
\begin{verbatim}
?- induce_par([train],P),
   test(P,[test],LL,AUCROC,ROC,AUCPR,PR).
\end{verbatim}
Or you can test the input program on the fold \verb|test| with
\begin{verbatim}
?- in(P),
   test(P,[test],LL,AUCROC,ROC,AUCPR,PR).
\end{verbatim}
By including
\begin{verbatim}
:- use_rendering(c3).
:- use_rendering(lpad).
\end{verbatim}
in the code before \verb|:- sc.| the curves will be shown as graphs and the output program will be pretty printed.



\subsubsection{Structure Learning}
To execute SLIPCOVER,
prepare an input file in the editor panel as indicated above 
and call
\begin{verbatim}
?- induce(<list of folds>,P).
\end{verbatim}
where \verb|<list of folds>| is a list of the folds for training and
\verb|P| will contain the learned program.

For example \href{http://cplint.lamping.unife.it/example/bongard.pl}{\texttt{bongard.pl}}, you can perform structure learning on the \verb|train| fold with 
\begin{verbatim}
?- induce([train],P).
\end{verbatim}
A program can also be tested on a test set with \verb|test/7| as
described above.

\input{learning_par}

\section{Download Query Results through an API}
The results of queries can also be downloaded programmatically by directly
approaching the Pengine API. Example client code is 
\href{https://github.com/friguzzi/swish/tree/master/client}{available}.  For example, the \verb|swish-ask.sh| client
can be used with bash to download the results for a query in CSV.  The call
below downloads a CSV file for the coin example.
\begin{verbatim}
$ bash swish-ask.sh --server=http://cplint.lamping.unife.it \   
  examples/inference/coin.pl Prob "prob(heads(coin),Prob)"
\end{verbatim}
The script can ask queries against Prolog scripts stored in 
\url{http://cplint.lamping.unife.it} by specifying
the script on the commandline.  User defined files stored
in \texttt{cplint} on SWISH (locations of type
\url{http://cplint.lamping.unife.it/p/coin_user.pl}) can
be directly used, for example:
\begin{verbatim}
$ bash swish-ask.sh --server=http://cplint.lamping.unife.it \
  coin_user.pl Prob "prob(heads(coin),Prob)"
\end{verbatim}
Example programs can be used by specifying the folder portion of the url of the example,
as in the first coin example above where the url for the program is 
\url{http://cplint.lamping.unife.it/examples/inference/coin.pl}.

Results can be downloaded in JSON using the option \verb|--json-s| or
\verb|--json-html|.
With the first the output is in a simple string format where Prolog terms are sent using quoted write, the latter serialize responses as HTML strings. E.g.
\begin{verbatim}
$ bash swish-ask.sh --json-s --server=http://cplint.lamping.unife.it \
  coin_user.pl Prob "prob(heads(coin),Prob)"
\end{verbatim}
The JSON format can also be modified. See
\url{http://www.swi-prolog.org/pldoc/doc_for?object=pengines%3Aevent_to_json/4}.

Prolog can exploit the Pengine API directly.  For example, the above can
be called as:
\begin{verbatim}
?- [library(pengines)].
?- pengine_rpc('http://cplint.lamping.unife.it',
     prob(heads(coin),Prob),
     [ src_url('https://raw.githubusercontent.com/friguzzi/swish/\  
master/examples/inference/coin.pl'),
     application(swish)
     ]).
Prob = 0.51.
?-
\end{verbatim}

\section{Manual in PDF}
A PDF version of the manual is available at
\url{https://github.com/friguzzi/cplint/blob/master/doc/help-cplint.pdf}.
\section{Bibliography}
\bibliographystyle{plain}
\bibliography{bib}
\end{document}